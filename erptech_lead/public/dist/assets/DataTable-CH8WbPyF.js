import{u as G,n as _,a as i,w,x as L,j as e,B as O,k as o,C as $,y as W,z as J,D as h,E as K,G as Q,H as X,l as s}from"./index-DbfsOBPs.js";import{u as Y,a as Z,b as ee,g as te,h as se,i as le,j as S,k as ne,l as re,m as ae,n as oe,C as ie,c as de,F as ce,f as u,T as ge,d as ue,S as xe,e as me,P as be}from"./columns-Bjqivsk2.js";import{P as fe}from"./Page-C35G2W2r.js";import{T as pe}from"./Toolbar-WM2CwLRN.js";import{g as we}from"./getUserAgentBrowser-hdkbEg6a.js";const he=we()==="Safari";function Se({pageName:x,doctype:c,fields:je,addNewRoute:j="add-new",hideAddNew:R=!1,storageKey:m="default",isPrint:y=!1,showPrint:C=!1,showOnlyPrint:k=!1,data:b=[],info:g=null,search:d={doctype:c,page:1,page_length:10,fields:null},setSearch:F=()=>{},onDeleteRow:P=()=>{},onDeleteRows:N=()=>{}}){const{cardSkin:v}=G(),T=_(),[M,f]=Y(),[n,I]=i.useState({enableSorting:!0,enableColumnFilters:!0,enableFullScreen:!1,enableRowDense:!1}),[z,D]=i.useState(""),[V,E]=i.useState([]),[q,A]=w(`column-visibility-${m}`,{}),[B,H]=w(`column-pinning-${m}`,{}),p=i.useRef(),{width:U}=Z({ref:p}),r=ee({data:b,columns:ie(g==null?void 0:g.fields,[],y,C,k),doctype:c,state:{globalFilter:z,sorting:V,columnVisibility:q,columnPinning:B,tableSettings:n},meta:{setTableSettings:I,deleteRow:l=>{f(),P(l)},deleteRows:l=>{f(),N(l)}},filterFns:{fuzzy:S},enableSorting:n.enableSorting,enableColumnFilters:n.enableColumnFilters,getCoreRowModel:oe(),onGlobalFilterChange:D,getFilteredRowModel:ae(),getFacetedUniqueValues:re(),getFacetedMinMaxValues:ne(),globalFilterFn:S,onSortingChange:E,getSortedRowModel:le(),getExpandedRowModel:se(),getRowCanExpand:()=>!0,getPaginationRowModel:te(),onColumnVisibilityChange:A,onColumnPinningChange:H,autoResetPageIndex:M});return L(()=>r.resetRowSelection(),[b]),de(n.enableFullScreen),e.jsx(fe,{title:x,children:e.jsxs("div",{className:"transition-content grid grid-cols-1 grid-rows-[auto_auto_1fr] px-(--margin-x) py-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e.jsx("div",{className:"min-w-0",children:e.jsx("h2",{className:"truncate text-lg font-medium text-gray-800 dark:text-dark-50",children:x})}),!R&&e.jsxs(O,{className:"h-7 space-x-1 rounded-md px-2 text-xs",color:"primary",onClick:()=>T(j),children:[e.jsx(ce,{className:"size-4"}),e.jsxs("span",{children:["New ",c]})]})]}),e.jsxs("div",{className:o("flex flex-col pt-2",n.enableFullScreen&&"fixed inset-0 z-61 h-full w-full bg-white pt-2 dark:bg-dark-900"),children:[e.jsx(pe,{table:r}),e.jsxs($,{className:o("relative mt-2 flex grow flex-col",n.enableFullScreen&&"overflow-hidden"),ref:p,children:[e.jsx("div",{className:"table-wrapper min-w-full grow overflow-x-auto",children:e.jsxs(W,{hoverable:!0,dense:n.enableRowDense,sticky:n.enableFullScreen,className:"w-full text-left rtl:text-right",children:[e.jsx(J,{children:r.getHeaderGroups().map(l=>e.jsx(h,{children:l.headers.map(t=>e.jsxs(K,{className:o("bg-gray-200 font-bold text-xs uppercase text-gray-800 dark:bg-dark-800 dark:text-dark-100 first:ltr:rounded-tl-lg last:ltr:rounded-tr-lg first:rtl:rounded-tr-lg last:rtl:rounded-tl-lg px-3 py-3 max-w-xs",t.column.getCanPin()&&[t.column.getIsPinned()==="left"&&"sticky z-2 ltr:left-0 rtl:right-0",t.column.getIsPinned()==="right"&&"sticky z-2 ltr:right-0 rtl:left-0"]),children:[t.column.getCanSort()?e.jsxs("div",{className:"flex cursor-pointer select-none items-center space-x-2",onClick:t.column.getToggleSortingHandler(),children:[e.jsx("span",{className:"flex-1 text-xs font-bold truncate",children:t.isPlaceholder?null:(()=>{const a=u(t.column.columnDef.header,t.getContext());return typeof a=="string"&&a.length>15?a.substring(0,15)+"...":a})()}),e.jsx(ge,{sorted:t.column.getIsSorted()})]}):t.isPlaceholder?null:e.jsx("span",{className:"text-xs font-bold truncate",children:(()=>{const a=u(t.column.columnDef.header,t.getContext());return typeof a=="string"&&a.length>15?a.substring(0,15)+"...":a})()}),t.column.getCanFilter()?e.jsx(ue,{column:t.column}):null]},t.id))},l.id))}),e.jsx(Q,{children:r.getRowModel().rows.map(l=>e.jsxs(i.Fragment,{children:[e.jsx(h,{className:o("relative border-y border-transparent border-b-gray-200 dark:border-b-dark-500",l.getIsExpanded()&&"border-dashed",l.getIsSelected()&&!he&&"row-selected after:pointer-events-none after:absolute after:inset-0 after:z-2 after:h-full after:w-full after:border-3 after:border-transparent after:bg-primary-500/10 ltr:after:border-l-primary-500 rtl:after:border-r-primary-500"),children:l.getVisibleCells().map(t=>e.jsxs(X,{className:o("relative text-xs px-2 py-1",t.column.id==="actions"?"overflow-visible":"truncate max-w-xs",v==="shadow-sm"?"dark:bg-dark-700":"dark:bg-dark-900",t.column.getCanPin()&&[t.column.getIsPinned()==="left"&&"sticky z-2 ltr:left-0 rtl:right-0",t.column.getIsPinned()==="right"&&"sticky z-2 ltr:right-0 rtl:left-0"]),children:[t.column.getIsPinned()&&e.jsx("div",{className:o("pointer-events-none absolute inset-0 border-gray-200 dark:border-dark-500",t.column.getIsPinned()==="left"?"ltr:border-r rtl:border-l":"ltr:border-l rtl:border-r")}),u(t.column.columnDef.cell,t.getContext())]},t.id))}),l.getIsExpanded()&&e.jsx("tr",{children:e.jsx("td",{colSpan:l.getVisibleCells().length,className:"p-0",children:e.jsx(xe,{row:l,cardWidth:U})})})]},l.id))})]})}),e.jsx(me,{table:r}),r.getCoreRowModel().rows.length>0&&e.jsx("div",{className:o("px-2 pb-2 sm:px-3 sm:pt-2",n.enableFullScreen&&"bg-gray-50 dark:bg-dark-800",!(r.getIsSomeRowsSelected()||r.getIsAllRowsSelected())&&"pt-2"),children:e.jsx(be,{table:r,count:(d==null?void 0:d.counts)??0,search:d,setSearch:F})})]})]})]})})}Se.propTypes={pageName:s.string.isRequired,doctype:s.string.isRequired,fields:s.arrayOf(s.string).isRequired,addNewRoute:s.string,hideAddNew:s.bool,storageKey:s.string,isPrint:s.bool,showPrint:s.bool,showOnlyPrint:s.bool,data:s.array,info:s.object,search:s.object,setSearch:s.func,onDeleteRow:s.func,onDeleteRows:s.func};export{Se as D};
