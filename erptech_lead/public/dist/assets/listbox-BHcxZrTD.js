import{K as V,y as H,b as he,a as Ee,o as x,c as y,r as Re,U as $e,$ as Ie,d as ye,w as Pe,_ as pe,e as Le,L as G,x as Me,n as Te,u as De,g as we,i as J,m as Ce,h as ke,j as _e,R as Fe,f as Ae,p as fe,N as Ne,k as Be,l as de,I as K,q as Qe,s as Ke,t as Ue,Q as Ve,v as se,A as He,P as Ge,C as je,D as qe,E as ze,M as Je,H as Xe,O as ce,J as We}from"./transition-BEPJcKhE.js";import{a as c,a5 as N,R as w}from"./index-CXdK2mEz.js";import{p as Ze,l as Ye,T as et,u as tt,j as ot}from"./use-by-comparator-CH0z9RXZ.js";import{s as nt,a as it}from"./use-text-value-58YI95vZ.js";import{c as R,u as at,f as re}from"./calculate-active-index-7qBK-Oid.js";import{l as rt}from"./frozen-BUEIK5Ko.js";import{Q as lt,u as st,I as ut,K as dt}from"./label-Be0Myku2.js";var ct=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ct||{}),pt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(pt||{}),ft=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ft||{}),vt=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetOptionsElement=8]="SetOptionsElement",e))(vt||{});function le(e,n=a=>a){let a=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=We(n(e.options.slice()),m=>m.dataRef.current.domRef.current),i=a?t.indexOf(a):null;return i===-1&&(i=null),{options:t,activeOptionIndex:i}}let bt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let n=e.activeOptionIndex,{isSelected:a}=e.dataRef.current,t=e.options.findIndex(i=>a(i.dataRef.current.value));return t!==-1&&(n=t),{...e,listboxState:0,activeOptionIndex:n,__demoMode:!1}},2(e,n){var a,t,i,m,S;if(e.dataRef.current.disabled||e.listboxState===1)return e;let p={...e,searchQuery:"",activationTrigger:(a=n.trigger)!=null?a:1,__demoMode:!1};if(n.focus===R.Nothing)return{...p,activeOptionIndex:null};if(n.focus===R.Specific)return{...p,activeOptionIndex:e.options.findIndex(u=>u.id===n.id)};if(n.focus===R.Previous){let u=e.activeOptionIndex;if(u!==null){let d=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((t=d.current)==null?void 0:t.previousElementSibling)===v.current||((i=v.current)==null?void 0:i.previousElementSibling)===null)return{...p,activeOptionIndex:g}}}}else if(n.focus===R.Next){let u=e.activeOptionIndex;if(u!==null){let d=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((m=d.current)==null?void 0:m.nextElementSibling)===v.current||((S=v.current)==null?void 0:S.nextElementSibling)===null)return{...p,activeOptionIndex:g}}}}let s=le(e),O=re(n,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...p,...s,activeOptionIndex:O}},3:(e,n)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let a=e.searchQuery!==""?0:1,t=e.searchQuery+n.value.toLowerCase(),i=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+a).concat(e.options.slice(0,e.activeOptionIndex+a)):e.options).find(S=>{var p;return!S.dataRef.current.disabled&&((p=S.dataRef.current.textValue)==null?void 0:p.startsWith(t))}),m=i?e.options.indexOf(i):-1;return m===-1||m===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:m,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,n)=>{let a={id:n.id,dataRef:n.dataRef},t=le(e,i=>[...i,a]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(a)),{...e,...t}},6:(e,n)=>{let a=le(e,t=>{let i=t.findIndex(m=>m.id===n.id);return i!==-1&&t.splice(i,1),t});return{...e,...a,activationTrigger:1}},7:(e,n)=>e.buttonElement===n.element?e:{...e,buttonElement:n.element},8:(e,n)=>e.optionsElement===n.element?e:{...e,optionsElement:n.element}},ue=c.createContext(null);ue.displayName="ListboxActionsContext";function X(e){let n=c.useContext(ue);if(n===null){let a=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,X),a}return n}let W=c.createContext(null);W.displayName="ListboxDataContext";function j(e){let n=c.useContext(W);if(n===null){let a=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,j),a}return n}function mt(e,n){return K(n.type,bt,e,n)}let xt=c.Fragment;function Ot(e,n){var a;let t=Ge(),{value:i,defaultValue:m,form:S,name:p,onChange:s,by:O,invalid:u=!1,disabled:d=t||!1,horizontal:g=!1,multiple:v=!1,__demoMode:o=!1,...h}=e;const A=g?"horizontal":"vertical";let k=H(n),P=Ye(m),[$=v?[]:void 0,L]=et(i,s,P),[D,E]=c.useReducer(mt,{dataRef:c.createRef(),listboxState:o?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,buttonElement:null,optionsElement:null,__demoMode:o}),_=c.useRef({static:!1,hold:!1}),F=c.useRef(new Map),b=tt(O),T=c.useCallback(f=>K(r.mode,{1:()=>$.some(I=>b(I,f)),0:()=>b($,f)}),[$]),r=c.useMemo(()=>({...D,value:$,disabled:d,invalid:u,mode:v?1:0,orientation:A,compare:b,isSelected:T,optionsPropsRef:_,listRef:F}),[$,d,u,v,D,F]);se(()=>{D.dataRef.current=r},[r]);let B=r.listboxState===0;je(B,[r.buttonElement,r.optionsElement],(f,I)=>{var C;E({type:1}),qe(I,ze.Loose)||(f.preventDefault(),(C=r.buttonElement)==null||C.focus())});let Z=c.useMemo(()=>({open:r.listboxState===0,disabled:d,invalid:u,value:$}),[r,d,$,u]),Y=x(f=>{let I=r.options.find(C=>C.id===f);I&&U(I.dataRef.current.value)}),ee=x(()=>{if(r.activeOptionIndex!==null){let{dataRef:f,id:I}=r.options[r.activeOptionIndex];U(f.current.value),E({type:2,focus:R.Specific,id:I})}}),te=x(()=>E({type:0})),q=x(()=>E({type:1})),z=fe(),oe=x((f,I,C)=>{z.dispose(),z.microTask(()=>f===R.Specific?E({type:2,focus:R.Specific,id:I,trigger:C}):E({type:2,focus:f,trigger:C}))}),ne=x((f,I)=>(E({type:5,id:f,dataRef:I}),()=>E({type:6,id:f}))),U=x(f=>K(r.mode,{0(){return L==null?void 0:L(f)},1(){let I=r.value.slice(),C=I.findIndex(ge=>b(ge,f));return C===-1?I.push(f):I.splice(C,1),L==null?void 0:L(I)}})),ie=x(f=>E({type:3,value:f})),l=x(()=>E({type:4})),M=x(f=>{E({type:7,element:f})}),Q=x(f=>{E({type:8,element:f})}),ae=c.useMemo(()=>({onChange:U,registerOption:ne,goToOption:oe,closeListbox:q,openListbox:te,selectActiveOption:ee,selectOption:Y,search:ie,clearSearch:l,setButtonElement:M,setOptionsElement:Q}),[]),[be,me]=dt({inherit:!0}),xe={ref:k},Oe=c.useCallback(()=>{if(P!==void 0)return L==null?void 0:L(P)},[L,P]),Se=G();return w.createElement(me,{value:be,props:{htmlFor:(a=r.buttonElement)==null?void 0:a.id},slot:{open:r.listboxState===0,disabled:d}},w.createElement(Je,null,w.createElement(ue.Provider,{value:ae},w.createElement(W.Provider,{value:r},w.createElement(Xe,{value:K(r.listboxState,{0:J.Open,1:J.Closed})},p!=null&&$!=null&&w.createElement(ot,{disabled:d,data:{[p]:$},form:S,onReset:Oe}),Se({ourProps:xe,theirProps:h,slot:Z,defaultTag:xt,name:"Listbox"}))))))}let St="button";function gt(e,n){var a;let t=j("Listbox.Button"),i=X("Listbox.Button"),m=c.useId(),S=st(),{id:p=S||`headlessui-listbox-button-${m}`,disabled:s=t.disabled||!1,autoFocus:O=!1,...u}=e,d=H(n,he(),i.setButtonElement),g=Ee(),v=x(r=>{switch(r.key){case y.Enter:Ze(r.currentTarget);break;case y.Space:case y.ArrowDown:r.preventDefault(),N.flushSync(()=>i.openListbox()),t.value||i.goToOption(R.First);break;case y.ArrowUp:r.preventDefault(),N.flushSync(()=>i.openListbox()),t.value||i.goToOption(R.Last);break}}),o=x(r=>{switch(r.key){case y.Space:r.preventDefault();break}}),h=x(r=>{var B;if(Re(r.currentTarget))return r.preventDefault();t.listboxState===0?(N.flushSync(()=>i.closeListbox()),(B=t.buttonElement)==null||B.focus({preventScroll:!0})):(r.preventDefault(),i.openListbox())}),A=x(r=>r.preventDefault()),k=ut([p]),P=$e(),{isFocusVisible:$,focusProps:L}=Ie({autoFocus:O}),{isHovered:D,hoverProps:E}=ye({isDisabled:s}),{pressed:_,pressProps:F}=Pe({disabled:s}),b=c.useMemo(()=>({open:t.listboxState===0,active:_||t.listboxState===0,disabled:s,invalid:t.invalid,value:t.value,hover:D,focus:$,autofocus:O}),[t.listboxState,t.value,s,D,$,_,t.invalid,O]),T=pe(g(),{ref:d,id:p,type:Le(e,t.buttonElement),"aria-haspopup":"listbox","aria-controls":(a=t.optionsElement)==null?void 0:a.id,"aria-expanded":t.listboxState===0,"aria-labelledby":k,"aria-describedby":P,disabled:s||void 0,autoFocus:O,onKeyDown:v,onKeyUp:o,onKeyPress:A,onClick:h},L,E,F);return G()({ourProps:T,theirProps:u,slot:b,defaultTag:St,name:"Listbox.Button"})}let ve=c.createContext(!1),ht="div",Et=ce.RenderStrategy|ce.Static;function Rt(e,n){var a,t;let i=c.useId(),{id:m=`headlessui-listbox-options-${i}`,anchor:S,portal:p=!1,modal:s=!0,transition:O=!1,...u}=e,d=Me(S),[g,v]=c.useState(null);d&&(p=!0);let o=j("Listbox.Options"),h=X("Listbox.Options"),A=Te(o.optionsElement),k=De(),[P,$]=we(O,g,k!==null?(k&J.Open)===J.Open:o.listboxState===0);Ce(P,o.buttonElement,h.closeListbox);let L=o.__demoMode?!1:s&&o.listboxState===0;ke(L,A);let D=o.__demoMode?!1:s&&o.listboxState===0;_e(D,{allowed:c.useCallback(()=>[o.buttonElement,o.optionsElement],[o.buttonElement,o.optionsElement])});let E=o.listboxState!==0,_=nt(E,o.buttonElement)?!1:P,F=P&&o.listboxState===1,b=rt(F,o.value),T=x(l=>o.compare(b,l)),r=c.useMemo(()=>{var l;if(d==null||!((l=d==null?void 0:d.to)!=null&&l.includes("selection")))return null;let M=o.options.findIndex(Q=>T(Q.dataRef.current.value));return M===-1&&(M=0),M},[d,o.options]),B=(()=>{if(d==null)return;if(r===null)return{...d,inner:void 0};let l=Array.from(o.listRef.current.values());return{...d,inner:{listRef:{current:l},index:r}}})(),[Z,Y]=Fe(B),ee=Ae(),te=H(n,d?Z:null,h.setOptionsElement,v),q=fe();c.useEffect(()=>{var l;let M=o.optionsElement;M&&o.listboxState===0&&M!==((l=Ne(M))==null?void 0:l.activeElement)&&(M==null||M.focus({preventScroll:!0}))},[o.listboxState,o.optionsElement]);let z=x(l=>{var M,Q;switch(q.dispose(),l.key){case y.Space:if(o.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),h.search(l.key);case y.Enter:if(l.preventDefault(),l.stopPropagation(),o.activeOptionIndex!==null){let{dataRef:ae}=o.options[o.activeOptionIndex];h.onChange(ae.current.value)}o.mode===0&&(N.flushSync(()=>h.closeListbox()),(M=o.buttonElement)==null||M.focus({preventScroll:!0}));break;case K(o.orientation,{vertical:y.ArrowDown,horizontal:y.ArrowRight}):return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Next);case K(o.orientation,{vertical:y.ArrowUp,horizontal:y.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Previous);case y.Home:case y.PageUp:return l.preventDefault(),l.stopPropagation(),h.goToOption(R.First);case y.End:case y.PageDown:return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Last);case y.Escape:l.preventDefault(),l.stopPropagation(),N.flushSync(()=>h.closeListbox()),(Q=o.buttonElement)==null||Q.focus({preventScroll:!0});return;case y.Tab:l.preventDefault(),l.stopPropagation(),N.flushSync(()=>h.closeListbox()),Be(o.buttonElement,l.shiftKey?de.Previous:de.Next);break;default:l.key.length===1&&(h.search(l.key),q.setTimeout(()=>h.clearSearch(),350));break}}),oe=(a=o.buttonElement)==null?void 0:a.id,ne=c.useMemo(()=>({open:o.listboxState===0}),[o.listboxState]),U=pe(d?ee():{},{id:m,ref:te,"aria-activedescendant":o.activeOptionIndex===null||(t=o.options[o.activeOptionIndex])==null?void 0:t.id,"aria-multiselectable":o.mode===1?!0:void 0,"aria-labelledby":oe,"aria-orientation":o.orientation,onKeyDown:z,role:"listbox",tabIndex:o.listboxState===0?0:void 0,style:{...u.style,...Y,"--button-width":Ke(o.buttonElement,!0).width},...Qe($)}),ie=G();return w.createElement(Ue,{enabled:p?e.static||P:!1},w.createElement(W.Provider,{value:o.mode===1?o:{...o,isSelected:T}},ie({ourProps:U,theirProps:u,slot:ne,defaultTag:ht,features:Et,visible:_,name:"Listbox.Options"})))}let $t="div";function It(e,n){let a=c.useId(),{id:t=`headlessui-listbox-option-${a}`,disabled:i=!1,value:m,...S}=e,p=c.useContext(ve)===!0,s=j("Listbox.Option"),O=X("Listbox.Option"),u=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===t:!1,d=s.isSelected(m),g=c.useRef(null),v=it(g),o=Ve({disabled:i,value:m,domRef:g,get textValue(){return v()}}),h=H(n,g,b=>{b?s.listRef.current.set(t,b):s.listRef.current.delete(t)});se(()=>{if(!s.__demoMode&&s.listboxState===0&&u&&s.activationTrigger!==0)return He().requestAnimationFrame(()=>{var b,T;(T=(b=g.current)==null?void 0:b.scrollIntoView)==null||T.call(b,{block:"nearest"})})},[g,u,s.__demoMode,s.listboxState,s.activationTrigger,s.activeOptionIndex]),se(()=>{if(!p)return O.registerOption(t,o)},[o,t,p]);let A=x(b=>{var T;if(i)return b.preventDefault();O.onChange(m),s.mode===0&&(N.flushSync(()=>O.closeListbox()),(T=s.buttonElement)==null||T.focus({preventScroll:!0}))}),k=x(()=>{if(i)return O.goToOption(R.Nothing);O.goToOption(R.Specific,t)}),P=at(),$=x(b=>{P.update(b),!i&&(u||O.goToOption(R.Specific,t,0))}),L=x(b=>{P.wasMoved(b)&&(i||u||O.goToOption(R.Specific,t,0))}),D=x(b=>{P.wasMoved(b)&&(i||u&&O.goToOption(R.Nothing))}),E=c.useMemo(()=>({active:u,focus:u,selected:d,disabled:i,selectedOption:d&&p}),[u,d,i,p]),_=p?{}:{id:t,ref:h,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":d,disabled:void 0,onClick:A,onFocus:k,onPointerEnter:$,onMouseEnter:$,onPointerMove:L,onMouseMove:L,onPointerLeave:D,onMouseLeave:D},F=G();return!d&&p?null:F({ourProps:_,theirProps:S,slot:E,defaultTag:$t,name:"Listbox.Option"})}let yt=c.Fragment;function Pt(e,n){let{options:a,placeholder:t,...i}=e,m={ref:H(n)},S=j("ListboxSelectedOption"),p=c.useMemo(()=>({}),[]),s=S.value===void 0||S.value===null||S.mode===1&&Array.isArray(S.value)&&S.value.length===0,O=G();return w.createElement(ve.Provider,{value:!0},O({ourProps:m,theirProps:{...i,children:w.createElement(w.Fragment,null,t&&s?t:a)},slot:p,defaultTag:yt,name:"ListboxSelectedOption"}))}let Lt=V(Ot),Mt=V(gt),Tt=lt,Dt=V(Rt),wt=V(It),Ct=V(Pt),Kt=Object.assign(Lt,{Button:Mt,Label:Tt,Options:Dt,Option:wt,SelectedOption:Ct});export{Dt as G,Kt as M,Mt as N,wt as V};
