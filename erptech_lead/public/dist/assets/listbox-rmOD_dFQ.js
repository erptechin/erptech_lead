import{K as V,y as H,i as he,h as Ee,o as x,c as y,r as Re,W as $e,$ as Ie,d as ye,w as Pe,a as pe,e as Le,L as G,x as Me,k as Te,l as De,m as we,p as J,q as Ce,v as _e,A as ke,R as Fe,j as Ae,B as fe,b as Be,C as Ne,F as de,u as K,D as Qe,E as Ke,H as Ue,s as Ve,n as se,I as He,V as Ge,M as je,N as qe,Q as ze,S as Je,U as We,O as ce,_ as Xe}from"./transition-Bjlj-wUW.js";import{a as c,_ as B,R as w}from"./index-LumR9LpT.js";import{p as Ze,l as Ye,T as et,u as tt,j as ot}from"./use-by-comparator-DvNQncvR.js";import{s as nt,a as at}from"./use-text-value-DvuwZjGX.js";import{c as R,u as it,f as re}from"./calculate-active-index-P522dhW6.js";import{l as rt}from"./frozen-Chw8VnFV.js";import{Q as lt,u as st,I as ut,K as dt}from"./label-Bynhy_B1.js";var ct=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ct||{}),pt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(pt||{}),ft=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ft||{}),vt=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetOptionsElement=8]="SetOptionsElement",e))(vt||{});function le(e,n=i=>i){let i=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=Xe(n(e.options.slice()),m=>m.dataRef.current.domRef.current),a=i?t.indexOf(i):null;return a===-1&&(a=null),{options:t,activeOptionIndex:a}}let bt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let n=e.activeOptionIndex,{isSelected:i}=e.dataRef.current,t=e.options.findIndex(a=>i(a.dataRef.current.value));return t!==-1&&(n=t),{...e,listboxState:0,activeOptionIndex:n,__demoMode:!1}},2(e,n){var i,t,a,m,S;if(e.dataRef.current.disabled||e.listboxState===1)return e;let p={...e,searchQuery:"",activationTrigger:(i=n.trigger)!=null?i:1,__demoMode:!1};if(n.focus===R.Nothing)return{...p,activeOptionIndex:null};if(n.focus===R.Specific)return{...p,activeOptionIndex:e.options.findIndex(u=>u.id===n.id)};if(n.focus===R.Previous){let u=e.activeOptionIndex;if(u!==null){let d=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((t=d.current)==null?void 0:t.previousElementSibling)===v.current||((a=v.current)==null?void 0:a.previousElementSibling)===null)return{...p,activeOptionIndex:g}}}}else if(n.focus===R.Next){let u=e.activeOptionIndex;if(u!==null){let d=e.options[u].dataRef.current.domRef,g=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(g!==null){let v=e.options[g].dataRef.current.domRef;if(((m=d.current)==null?void 0:m.nextElementSibling)===v.current||((S=v.current)==null?void 0:S.nextElementSibling)===null)return{...p,activeOptionIndex:g}}}}let s=le(e),O=re(n,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...p,...s,activeOptionIndex:O}},3:(e,n)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.searchQuery!==""?0:1,t=e.searchQuery+n.value.toLowerCase(),a=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+i).concat(e.options.slice(0,e.activeOptionIndex+i)):e.options).find(S=>{var p;return!S.dataRef.current.disabled&&((p=S.dataRef.current.textValue)==null?void 0:p.startsWith(t))}),m=a?e.options.indexOf(a):-1;return m===-1||m===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:m,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,n)=>{let i={id:n.id,dataRef:n.dataRef},t=le(e,a=>[...a,i]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(i)),{...e,...t}},6:(e,n)=>{let i=le(e,t=>{let a=t.findIndex(m=>m.id===n.id);return a!==-1&&t.splice(a,1),t});return{...e,...i,activationTrigger:1}},7:(e,n)=>e.buttonElement===n.element?e:{...e,buttonElement:n.element},8:(e,n)=>e.optionsElement===n.element?e:{...e,optionsElement:n.element}},ue=c.createContext(null);ue.displayName="ListboxActionsContext";function W(e){let n=c.useContext(ue);if(n===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,W),i}return n}let X=c.createContext(null);X.displayName="ListboxDataContext";function j(e){let n=c.useContext(X);if(n===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,j),i}return n}function mt(e,n){return K(n.type,bt,e,n)}let xt=c.Fragment;function Ot(e,n){var i;let t=Ge(),{value:a,defaultValue:m,form:S,name:p,onChange:s,by:O,invalid:u=!1,disabled:d=t||!1,horizontal:g=!1,multiple:v=!1,__demoMode:o=!1,...h}=e;const A=g?"horizontal":"vertical";let _=H(n),P=Ye(m),[$=v?[]:void 0,L]=et(a,s,P),[D,E]=c.useReducer(mt,{dataRef:c.createRef(),listboxState:o?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,buttonElement:null,optionsElement:null,__demoMode:o}),k=c.useRef({static:!1,hold:!1}),F=c.useRef(new Map),b=tt(O),T=c.useCallback(f=>K(r.mode,{1:()=>$.some(I=>b(I,f)),0:()=>b($,f)}),[$]),r=c.useMemo(()=>({...D,value:$,disabled:d,invalid:u,mode:v?1:0,orientation:A,compare:b,isSelected:T,optionsPropsRef:k,listRef:F}),[$,d,u,v,D,F]);se(()=>{D.dataRef.current=r},[r]);let N=r.listboxState===0;je(N,[r.buttonElement,r.optionsElement],(f,I)=>{var C;E({type:1}),qe(I,ze.Loose)||(f.preventDefault(),(C=r.buttonElement)==null||C.focus())});let Z=c.useMemo(()=>({open:r.listboxState===0,disabled:d,invalid:u,value:$}),[r,d,$,u]),Y=x(f=>{let I=r.options.find(C=>C.id===f);I&&U(I.dataRef.current.value)}),ee=x(()=>{if(r.activeOptionIndex!==null){let{dataRef:f,id:I}=r.options[r.activeOptionIndex];U(f.current.value),E({type:2,focus:R.Specific,id:I})}}),te=x(()=>E({type:0})),q=x(()=>E({type:1})),z=fe(),oe=x((f,I,C)=>{z.dispose(),z.microTask(()=>f===R.Specific?E({type:2,focus:R.Specific,id:I,trigger:C}):E({type:2,focus:f,trigger:C}))}),ne=x((f,I)=>(E({type:5,id:f,dataRef:I}),()=>E({type:6,id:f}))),U=x(f=>K(r.mode,{0(){return L==null?void 0:L(f)},1(){let I=r.value.slice(),C=I.findIndex(ge=>b(ge,f));return C===-1?I.push(f):I.splice(C,1),L==null?void 0:L(I)}})),ae=x(f=>E({type:3,value:f})),l=x(()=>E({type:4})),M=x(f=>{E({type:7,element:f})}),Q=x(f=>{E({type:8,element:f})}),ie=c.useMemo(()=>({onChange:U,registerOption:ne,goToOption:oe,closeListbox:q,openListbox:te,selectActiveOption:ee,selectOption:Y,search:ae,clearSearch:l,setButtonElement:M,setOptionsElement:Q}),[]),[be,me]=dt({inherit:!0}),xe={ref:_},Oe=c.useCallback(()=>{if(P!==void 0)return L==null?void 0:L(P)},[L,P]),Se=G();return w.createElement(me,{value:be,props:{htmlFor:(i=r.buttonElement)==null?void 0:i.id},slot:{open:r.listboxState===0,disabled:d}},w.createElement(Je,null,w.createElement(ue.Provider,{value:ie},w.createElement(X.Provider,{value:r},w.createElement(We,{value:K(r.listboxState,{0:J.Open,1:J.Closed})},p!=null&&$!=null&&w.createElement(ot,{disabled:d,data:{[p]:$},form:S,onReset:Oe}),Se({ourProps:xe,theirProps:h,slot:Z,defaultTag:xt,name:"Listbox"}))))))}let St="button";function gt(e,n){var i;let t=j("Listbox.Button"),a=W("Listbox.Button"),m=c.useId(),S=st(),{id:p=S||`headlessui-listbox-button-${m}`,disabled:s=t.disabled||!1,autoFocus:O=!1,...u}=e,d=H(n,he(),a.setButtonElement),g=Ee(),v=x(r=>{switch(r.key){case y.Enter:Ze(r.currentTarget);break;case y.Space:case y.ArrowDown:r.preventDefault(),B.flushSync(()=>a.openListbox()),t.value||a.goToOption(R.First);break;case y.ArrowUp:r.preventDefault(),B.flushSync(()=>a.openListbox()),t.value||a.goToOption(R.Last);break}}),o=x(r=>{switch(r.key){case y.Space:r.preventDefault();break}}),h=x(r=>{var N;if(Re(r.currentTarget))return r.preventDefault();t.listboxState===0?(B.flushSync(()=>a.closeListbox()),(N=t.buttonElement)==null||N.focus({preventScroll:!0})):(r.preventDefault(),a.openListbox())}),A=x(r=>r.preventDefault()),_=ut([p]),P=$e(),{isFocusVisible:$,focusProps:L}=Ie({autoFocus:O}),{isHovered:D,hoverProps:E}=ye({isDisabled:s}),{pressed:k,pressProps:F}=Pe({disabled:s}),b=c.useMemo(()=>({open:t.listboxState===0,active:k||t.listboxState===0,disabled:s,invalid:t.invalid,value:t.value,hover:D,focus:$,autofocus:O}),[t.listboxState,t.value,s,D,$,k,t.invalid,O]),T=pe(g(),{ref:d,id:p,type:Le(e,t.buttonElement),"aria-haspopup":"listbox","aria-controls":(i=t.optionsElement)==null?void 0:i.id,"aria-expanded":t.listboxState===0,"aria-labelledby":_,"aria-describedby":P,disabled:s||void 0,autoFocus:O,onKeyDown:v,onKeyUp:o,onKeyPress:A,onClick:h},L,E,F);return G()({ourProps:T,theirProps:u,slot:b,defaultTag:St,name:"Listbox.Button"})}let ve=c.createContext(!1),ht="div",Et=ce.RenderStrategy|ce.Static;function Rt(e,n){var i,t;let a=c.useId(),{id:m=`headlessui-listbox-options-${a}`,anchor:S,portal:p=!1,modal:s=!0,transition:O=!1,...u}=e,d=Me(S),[g,v]=c.useState(null);d&&(p=!0);let o=j("Listbox.Options"),h=W("Listbox.Options"),A=Te(o.optionsElement),_=De(),[P,$]=we(O,g,_!==null?(_&J.Open)===J.Open:o.listboxState===0);Ce(P,o.buttonElement,h.closeListbox);let L=o.__demoMode?!1:s&&o.listboxState===0;_e(L,A);let D=o.__demoMode?!1:s&&o.listboxState===0;ke(D,{allowed:c.useCallback(()=>[o.buttonElement,o.optionsElement],[o.buttonElement,o.optionsElement])});let E=o.listboxState!==0,k=nt(E,o.buttonElement)?!1:P,F=P&&o.listboxState===1,b=rt(F,o.value),T=x(l=>o.compare(b,l)),r=c.useMemo(()=>{var l;if(d==null||!((l=d==null?void 0:d.to)!=null&&l.includes("selection")))return null;let M=o.options.findIndex(Q=>T(Q.dataRef.current.value));return M===-1&&(M=0),M},[d,o.options]),N=(()=>{if(d==null)return;if(r===null)return{...d,inner:void 0};let l=Array.from(o.listRef.current.values());return{...d,inner:{listRef:{current:l},index:r}}})(),[Z,Y]=Fe(N),ee=Ae(),te=H(n,d?Z:null,h.setOptionsElement,v),q=fe();c.useEffect(()=>{var l;let M=o.optionsElement;M&&o.listboxState===0&&M!==((l=Be(M))==null?void 0:l.activeElement)&&(M==null||M.focus({preventScroll:!0}))},[o.listboxState,o.optionsElement]);let z=x(l=>{var M,Q;switch(q.dispose(),l.key){case y.Space:if(o.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),h.search(l.key);case y.Enter:if(l.preventDefault(),l.stopPropagation(),o.activeOptionIndex!==null){let{dataRef:ie}=o.options[o.activeOptionIndex];h.onChange(ie.current.value)}o.mode===0&&(B.flushSync(()=>h.closeListbox()),(M=o.buttonElement)==null||M.focus({preventScroll:!0}));break;case K(o.orientation,{vertical:y.ArrowDown,horizontal:y.ArrowRight}):return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Next);case K(o.orientation,{vertical:y.ArrowUp,horizontal:y.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Previous);case y.Home:case y.PageUp:return l.preventDefault(),l.stopPropagation(),h.goToOption(R.First);case y.End:case y.PageDown:return l.preventDefault(),l.stopPropagation(),h.goToOption(R.Last);case y.Escape:l.preventDefault(),l.stopPropagation(),B.flushSync(()=>h.closeListbox()),(Q=o.buttonElement)==null||Q.focus({preventScroll:!0});return;case y.Tab:l.preventDefault(),l.stopPropagation(),B.flushSync(()=>h.closeListbox()),Ne(o.buttonElement,l.shiftKey?de.Previous:de.Next);break;default:l.key.length===1&&(h.search(l.key),q.setTimeout(()=>h.clearSearch(),350));break}}),oe=(i=o.buttonElement)==null?void 0:i.id,ne=c.useMemo(()=>({open:o.listboxState===0}),[o.listboxState]),U=pe(d?ee():{},{id:m,ref:te,"aria-activedescendant":o.activeOptionIndex===null||(t=o.options[o.activeOptionIndex])==null?void 0:t.id,"aria-multiselectable":o.mode===1?!0:void 0,"aria-labelledby":oe,"aria-orientation":o.orientation,onKeyDown:z,role:"listbox",tabIndex:o.listboxState===0?0:void 0,style:{...u.style,...Y,"--button-width":Ke(o.buttonElement,!0).width},...Qe($)}),ae=G();return w.createElement(Ue,{enabled:p?e.static||P:!1},w.createElement(X.Provider,{value:o.mode===1?o:{...o,isSelected:T}},ae({ourProps:U,theirProps:u,slot:ne,defaultTag:ht,features:Et,visible:k,name:"Listbox.Options"})))}let $t="div";function It(e,n){let i=c.useId(),{id:t=`headlessui-listbox-option-${i}`,disabled:a=!1,value:m,...S}=e,p=c.useContext(ve)===!0,s=j("Listbox.Option"),O=W("Listbox.Option"),u=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===t:!1,d=s.isSelected(m),g=c.useRef(null),v=at(g),o=Ve({disabled:a,value:m,domRef:g,get textValue(){return v()}}),h=H(n,g,b=>{b?s.listRef.current.set(t,b):s.listRef.current.delete(t)});se(()=>{if(!s.__demoMode&&s.listboxState===0&&u&&s.activationTrigger!==0)return He().requestAnimationFrame(()=>{var b,T;(T=(b=g.current)==null?void 0:b.scrollIntoView)==null||T.call(b,{block:"nearest"})})},[g,u,s.__demoMode,s.listboxState,s.activationTrigger,s.activeOptionIndex]),se(()=>{if(!p)return O.registerOption(t,o)},[o,t,p]);let A=x(b=>{var T;if(a)return b.preventDefault();O.onChange(m),s.mode===0&&(B.flushSync(()=>O.closeListbox()),(T=s.buttonElement)==null||T.focus({preventScroll:!0}))}),_=x(()=>{if(a)return O.goToOption(R.Nothing);O.goToOption(R.Specific,t)}),P=it(),$=x(b=>{P.update(b),!a&&(u||O.goToOption(R.Specific,t,0))}),L=x(b=>{P.wasMoved(b)&&(a||u||O.goToOption(R.Specific,t,0))}),D=x(b=>{P.wasMoved(b)&&(a||u&&O.goToOption(R.Nothing))}),E=c.useMemo(()=>({active:u,focus:u,selected:d,disabled:a,selectedOption:d&&p}),[u,d,a,p]),k=p?{}:{id:t,ref:h,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":d,disabled:void 0,onClick:A,onFocus:_,onPointerEnter:$,onMouseEnter:$,onPointerMove:L,onMouseMove:L,onPointerLeave:D,onMouseLeave:D},F=G();return!d&&p?null:F({ourProps:k,theirProps:S,slot:E,defaultTag:$t,name:"Listbox.Option"})}let yt=c.Fragment;function Pt(e,n){let{options:i,placeholder:t,...a}=e,m={ref:H(n)},S=j("ListboxSelectedOption"),p=c.useMemo(()=>({}),[]),s=S.value===void 0||S.value===null||S.mode===1&&Array.isArray(S.value)&&S.value.length===0,O=G();return w.createElement(ve.Provider,{value:!0},O({ourProps:m,theirProps:{...a,children:w.createElement(w.Fragment,null,t&&s?t:i)},slot:p,defaultTag:yt,name:"ListboxSelectedOption"}))}let Lt=V(Ot),Mt=V(gt),Tt=lt,Dt=V(Rt),wt=V(It),Ct=V(Pt),Kt=Object.assign(Lt,{Button:Mt,Label:Tt,Options:Dt,Option:wt,SelectedOption:Ct});export{Dt as G,Kt as M,Mt as N,wt as V};
